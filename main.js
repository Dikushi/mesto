(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._title=e.name,this._link=e.link,this._templateSelectorById=n,this._element=this._getTemplate(),this._handleCardClick=r}var n,r;return n=t,(r=[{key:"generateCard",value:function(){return this._setEvetListeners(),this._itemImage=this._element.querySelector(".elements__item-image"),this._infoText=this._element.querySelector(".elements__info-text"),this._itemImage.src=this._link,this._itemImage.alt=this._link,this._infoText.textContent=this._title,this._element}},{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelectorById).content.querySelector(".elements__item").cloneNode(!0)}},{key:"_handleDeleteButton",value:function(){this._element.remove(),this._element=null}},{key:"_handleLikeButton",value:function(){this._element.querySelector(".elements__info-like").classList.toggle("elements__info-like_active")}},{key:"_handlePreviewImage",value:function(){var e={src:this._link,alt:this._title,title:this._title};this._handleCardClick(e)}},{key:"_setEvetListeners",value:function(){var e=this;this._element.querySelector(".elements__info-like").addEventListener("click",(function(){e._handleLikeButton()})),this._element.querySelector(".elements__delete-card").addEventListener("click",(function(){e._handleDeleteButton()})),this._element.querySelector(".elements__item-image").addEventListener("click",(function(){e._handlePreviewImage()}))}}])&&e(n.prototype,r),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._elemForm=n,this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._inputList=Array.from(this._elemForm.querySelectorAll(this._inputSelector)),this._buttonElement=this._elemForm.querySelector(this._submitButtonSelector)}var t,r;return t=e,(r=[{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"_showValidityError",value:function(e){var t=this._elemForm.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.classList.add(this._errorClass),t.textContent=e.validationMessage}},{key:"hideValidityError",value:function(e){var t=this._elemForm.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}},{key:"_showInputValidity",value:function(e){e.validity.valid?this.hideValidityError(e):this._showValidityError(e)}},{key:"_checkinputValidity",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"toggleButtonState",value:function(){this._checkinputValidity()?(this._buttonElement.setAttribute("disabled",""),this._buttonElement.classList.add(this._inactiveButtonClass)):(this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._inactiveButtonClass))}},{key:"_setEventListeners",value:function(){var e=this;this.toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._showInputValidity(t),e.toggleButtonState()}))}))}}])&&n(t.prototype,r),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupSelector=t,this._popupCloseButton=this._popupSelector.querySelector(".popup__close"),this._classPopupOpen="popup_opened",this._handleEscClose=this._handleEscClose.bind(this),this._ESC_KEY="Escape"}var t,n;return t=e,(n=[{key:"open",value:function(){this._popupSelector.classList.add(this._classPopupOpen),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popupSelector.classList.remove(this._classPopupOpen),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){e.key===this._ESC_KEY&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popupSelector.addEventListener("click",(function(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__close"))&&e.close()}))}},{key:"removeEventListeners",value:function(){var e=this;this._popupSelector.addEventListener("click",(function(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__close"))&&e.close()}))}}])&&o(t.prototype,n),e}();function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function s(e,t){var n,r=t.submitFormCallBack;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=i.call(this,e))._submitFormCallBack=r,n._inputs=n._popupSelector.querySelectorAll(".popup__input"),n._form=n._popupSelector.querySelector(".popup__form"),n._button=n._popupSelector.querySelector(".popup__save"),n}return t=s,(n=[{key:"close",value:function(){a(p(s.prototype),"close",this).call(this),this._form.reset()}},{key:"_handleSumbitForm",value:function(e){e.preventDefault(),this._submitFormCallBack(this._getInputValues()),this.close()}},{key:"_getInputValues",value:function(){var e=this;return this._formsValues={},this._inputs.forEach((function(t){e._formsValues[t.name]=t.value})),this._formsValues}},{key:"setEventListeners",value:function(){a(p(s.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",this._handleSumbitForm.bind(this))}}])&&l(t.prototype,n),s}(i);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(r);if(o){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e))._imageData=t._popupSelector.querySelector(".popup__image"),t._imageName=t._popupSelector.querySelector(".popup__image-name"),t}return t=s,(n=[{key:"open",value:function(e){y(v(s.prototype),"open",this).call(this),this._imageData.src=e.link,this._imageData.alt=e.name,this._imageName.textContent=e.name}}])&&h(t.prototype,n),s}(i);function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._containerSelector=n}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){t._renderer(e)}))}},{key:"addItemPrepend",value:function(e){this._containerSelector.prepend(e)}},{key:"addItemAppend",value:function(e){this._containerSelector.append(e)}}])&&S(t.prototype,n),e}();function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var E=function(){function e(t){var n=t.selectorUserName,r=t.selectorUserJob;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._selectorUserName=n,this._selectorUserJob=r,this.getUserInfo=this.getUserInfo.bind(this)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._selectorUserName.textContent,job:this._selectorUserJob.textContent}}},{key:"setUserInfo",value:function(e){this._selectorUserName.textContent=e.name,this._selectorUserJob.textContent=e.job}}])&&k(t.prototype,n),e}(),w={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},C=document.querySelector(".root"),L=C.querySelector(".profile__info-name"),q=C.querySelector(".profile__info-job"),O=C.querySelector(".profile__edit-button"),j=C.querySelector(".profile__add-button"),B=C.querySelector(".popup_type_edit-profile"),P=C.querySelector(".popup_type_preview-image"),I=C.querySelector(".popup_type_add-card"),x=(B.querySelector(".popup__close_type_edit-profile"),B.querySelector(".popup__form_type_edit-profile")),V=(P.querySelector(".popup__image"),P.querySelector(".popup__image-name"),P.querySelector(".popup__close_type_preview-card"),I.querySelector(".popup__close_type_add-card"),I.querySelector(".popup__form_type_add-card")),R=x.querySelector(".popup__input_type_name"),U=x.querySelector(".popup__input_type_job"),T=V.querySelector(".popup__input_type_photo-name"),F=V.querySelector(".popup__input_type_photo-link"),D=(document.querySelector("#card").content,C.querySelector(".elements")),N=new E({selectorUserName:L,selectorUserJob:q}),A=new b(P);A.setEventListeners();var J=new f(B,{submitFormCallBack:function(e){N.setUserInfo(e)}});J.setEventListeners();var K=new f(I,{submitFormCallBack:function(e){var t={name:e["photo-name"],link:e["photo-link"]};Y.addItemPrepend(M(t))}});K.setEventListeners();var Y=new g({renderer:function(e){Y.addItemAppend(M(e))}},D),z=function(e){var t={name:e.title,link:e.src};A.open(t)};function M(e){return new t(e,"#card",z).generateCard()}Y.renderItems([{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}]);var G=new r(w,x),H=new r(w,V);G.enableValidation(),H.enableValidation(),O.addEventListener("click",(function(){J.open(),R.value=N.getUserInfo().name,U.value=N.getUserInfo().job,G.toggleButtonState(),G.hideValidityError(R),G.hideValidityError(U)})),j.addEventListener("click",(function(){K.open(),H.toggleButtonState(),H.hideValidityError(T),H.hideValidityError(F)}))})();